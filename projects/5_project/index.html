<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> Enhanced RAG | Sina Torfi </title> <meta name="author" content="Sina Torfi"> <meta name="description" content="Enhanced Retrieval Augmented Generation System, Advanced Techniques for Improved Context and Accuracy in Conversational AI"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%9A%9B%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://astorfi.github.io/projects/5_project/"> <script src="/assets/js/theme.js?9a0c749ec5240d9cda97bc72359a72c0"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>initTheme();</script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> <span class="font-weight-bold">Sina</span> Torfi </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">Start Here </a> </li> <li class="nav-item active"> <a class="nav-link" href="/projects/">Projects <span class="sr-only">(current)</span> </a> </li> <li class="nav-item "> <a class="nav-link" href="/repositories/">Repositories </a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">Enhanced RAG</h1> <p class="post-description">Enhanced Retrieval Augmented Generation System, Advanced Techniques for Improved Context and Accuracy in Conversational AI</p> </header> <article> <div class="row justify-content-sm-center"> <div class="col-sm-8 mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/projects/enhanced_rag-480.webp 480w,/assets/img/projects/enhanced_rag-800.webp 800w,/assets/img/projects/enhanced_rag-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/projects/enhanced_rag.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Enhanced Retrieval Augmented Generation System" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Enhanced Retrieval Augmented Generation System. </div> <hr> <h4 id="1-summary"><strong>1. Summary</strong></h4> <p>This project focused on enhancing the accuracy and contextual relevance of responses in conversational AI, particularly for customer support. Using advanced techniques to fine-tune embeddings and language models without labeled data, I built a Retrieval-Augmented Generation (RAG) system. This system integrates Large Language Models (LLMs) with retrieval techniques to improve user satisfaction, especially in customer support contexts, by delivering responses that are both accurate and contextually relevant.</p> <meta charset="UTF-8"> <meta name="viewport" content="width=device-width, initial-scale=1.0"> <title>Traditional vs. Enhanced RAG System Comparison</title> <style>body{font-family:Arial,sans-serif;background-color:#f4f4f9;color:#333;margin:0;padding:20px}h1{text-align:center;color:#333}table{width:100%;border-collapse:collapse;margin:20px 0;background-color:#fff}th,td{padding:12px;border:1px solid #ddd;text-align:left}th{background-color:#4caf50;color:white}tr:nth-child(even){background-color:#f2f2f2}.container{max-width:900px;margin:auto}</style> <div class="container"> <h1>Traditional vs. Enhanced RAG System Comparison</h1> <table> <tr> <th>Feature</th> <th>Traditional RAG System</th> <th>Enhanced RAG System</th> </tr> <tr> <td>Embeddings Quality</td> <td>Basic pre-trained embeddings</td> <td>Enhanced embeddings with Contrastive Learning and MoCo</td> </tr> <tr> <td>Retrieval Accuracy</td> <td>Standard retrieval with basic ranking</td> <td>Improved retrieval using Reciprocal Rank Fusion (RRF)</td> </tr> <tr> <td>Relevance of Responses</td> <td>Moderately relevant responses</td> <td>High contextual relevance with fine-tuned embeddings</td> </tr> <tr> <td>Fine-Tuning Data Requirements</td> <td>Requires labeled data</td> <td>Uses self-supervised learning with no labeled data needed</td> </tr> <tr> <td>Handling Domain-Specific Queries</td> <td>Limited adaptability</td> <td>Domain-Adaptive Pretraining (DAPT) for in-domain accuracy</td> </tr> <tr> <td>Prompt Engineering</td> <td>Minimal or no prompt tuning</td> <td>Custom prompts for high response accuracy and relevance</td> </tr> <tr> <td>Response Generation Quality</td> <td>Standard response generation</td> <td>Enhanced contextual depth and detail in generated responses</td> </tr> <tr> <td>User Satisfaction</td> <td>Moderate satisfaction</td> <td>Higher satisfaction with 30% reduction in irrelevant answers</td> </tr> <tr> <td>Technologies Used</td> <td>Basic retrieval techniques, pre-trained LLMs</td> <td>FAISS for similarity search, advanced RAG-Fusion, tuned LLMs</td> </tr> <tr> <td>Training Techniques</td> <td>Basic or supervised learning only</td> <td>Advanced self-supervised techniques like Contrastive Learning</td> </tr> <tr> <td>Quantitative Improvements</td> <td>Limited response accuracy</td> <td>+25% response accuracy, reduced irrelevant responses by 30%</td> </tr> <tr> <td>Application Suitability</td> <td>General-purpose conversational AI</td> <td>Tailored for customer support and high-accuracy applications</td> </tr> </table> </div> <hr> <h4 id="2-interesting-questions-answered-in-the-case-study"><strong>2. Interesting Questions Answered in the Case Study</strong></h4> <ul> <li>What specific problem in conversational AI systems did this project address?</li> <li>Why is improving accuracy and contextual relevance critical for customer-facing applications?</li> <li>How was the Enhanced Retrieval-Augmented Generation (RAG) system designed to improve responses?</li> <li>How were embeddings and language models fine-tuned without labeled data?</li> <li>What self-supervised learning techniques were used, and how did they improve embeddings?</li> <li>How did Contrastive Learning and Momentum Contrast enhance model performance?</li> <li>What role did Domain-Adaptive Pretraining (DAPT) and In-Context Learning play in the language model’s improvement?</li> <li>How was prompt engineering implemented to guide the language model’s responses?</li> <li>What is Reciprocal Rank Fusion (RRF), and how did it improve retrieval accuracy?</li> <li>Which tools and technologies, such as FAISS and LLMs, were used, and why?</li> <li>Can you explain the system’s workflow from user query to response generation?</li> <li>What quantitative improvements were achieved, such as the increase in response accuracy?</li> <li>How did users qualitatively perceive the improved AI responses?</li> <li>In what ways is this system applicable to customer support bots and virtual assistants?</li> <li>What challenges were encountered in applying self-supervised learning techniques without labeled data?</li> <li>How did combining retrieval methods with LLMs enhance user satisfaction?</li> <li>What impact did the project have on reducing irrelevant responses and increasing user engagement?</li> <li>How does this approach differ from traditional conversational AI methods?</li> <li>How did FAISS contribute to the efficiency of similarity searches within the system?</li> </ul> <hr> <h4 id="3-problem"><strong>3. Problem</strong></h4> <p>Many conversational AI systems struggle to provide accurate, contextually relevant responses to complex user queries. This project aimed to address this issue by developing a system that generates detailed, context-aware responses, suitable for high-demand customer-facing applications like customer support.</p> <hr> <h4 id="4-importance"><strong>4. Importance</strong></h4> <p>In customer service and similar settings, the relevance and accuracy of AI responses are critical for maintaining user satisfaction and engagement. By improving these aspects, the system has a direct impact on user retention and enhances the overall quality of customer interactions.</p> <hr> <h4 id="5-solution-approach"><strong>5. Solution Approach</strong></h4> <p>To address these challenges, I designed an Enhanced Retrieval-Augmented Generation (RAG) system with advanced techniques for fine-tuning embeddings and LLMs without labeled data. This system combines retrieval and language generation capabilities to ensure that responses are both accurate and relevant. Using RAG-Fusion with Large Language Models (LLMs), the system retrieves contextually relevant content and generates detail-rich responses aligned with user queries.</p> <p><strong>Prompt Engineering</strong>: Specific prompts were crafted to guide the LLM in generating accurate and contextually relevant responses, capturing nuances in user intent to ensure precision. Additionally, <strong>Reciprocal Rank Fusion (RRF)</strong> was applied to combine results from multiple retrieval models. This method prioritizes the most relevant responses and minimizes irrelevant answers.</p> <p>For fine-tuning embeddings and LLMs, advanced techniques were used to overcome the lack of labeled data. <strong>Self-supervised learning techniques</strong>, such as <strong>Contrastive Learning</strong> and <strong>Momentum Contrast (MoCo)</strong>, were implemented to enhance the quality of embeddings. Contrastive Learning helped the model recognize similar contexts by creating positive and negative pairs based on natural text variations, allowing the embeddings to capture semantic similarities and improve retrieval quality. MoCo created a queue of embeddings for efficient comparison, enabling the model to learn consistent embeddings over time.</p> <p>To enhance the LLM’s contextual understanding, <strong>Domain-Adaptive Pretraining (DAPT)</strong> and <strong>In-Context Learning</strong> were applied. DAPT involved pre-training the LLM on a large corpus of domain-specific, unlabeled data (e.g., customer support conversations), enabling the model to learn relevant vocabulary and context. In-Context Learning provided in-domain examples during training, allowing the model to infer context and generate relevant responses even without labeled datasets, thereby enhancing adaptability.</p> <hr> <h4 id="6-technical-implementation"><strong>6. Technical Implementation</strong></h4> <p>The project used a combination of tools and technologies, including <strong>FAISS</strong> for rapid, efficient similarity search and <strong>LLMs</strong> (such as OpenAI’s models) for generating responses with contextual depth and detail. Self-supervised and unsupervised fine-tuning techniques were essential to the implementation.</p> <p>The system workflow starts when a user submits a query. The retrieval process utilizes FAISS and RAG-Fusion to search for relevant information. The retrieved data is then passed to the LLM, where prompt engineering and in-context learning help generate a response aligned with the user’s intent.</p> <p><strong>Steps in the Workflow</strong>:</p> <ol> <li> <strong>User Query</strong>: A user submits a query.</li> <li> <strong>Retrieval</strong>: FAISS and RAG-Fusion retrieve the most relevant information based on the query.</li> <li> <strong>Response Generation</strong>: The retrieved information is fed into the LLM, which, guided by prompt engineering, produces a response.</li> <li> <strong>Delivery</strong>: The system delivers a response that is both contextually relevant and accurate.</li> </ol> <hr> <h4 id="7-results-and-outcomes"><strong>7. Results and Outcomes</strong></h4> <p>The project produced substantial quantitative improvements:</p> <ul> <li> <strong>Response Accuracy</strong>: Increased by 25%, thanks to enhanced embeddings that improved contextual relevance in retrievals.</li> <li> <strong>Reduction in Irrelevant Responses</strong>: Decreased by 30%, resulting in a smoother user experience and higher satisfaction.</li> </ul> <p>Qualitative feedback indicated that users experienced a significant improvement in the AI’s ability to understand and accurately answer their questions, leading to greater engagement. The system showed a boost in user interaction, with users spending more time and expressing more positive experiences when engaging with the AI.</p> <p>This system is applicable to customer support bots, virtual assistants, and automated help desks where accuracy and relevance in responses are crucial.</p> <hr> <h4 id="8-conclusion"><strong>8. Conclusion</strong></h4> <p>This project effectively improved the response accuracy and contextual relevance of conversational AI through advanced techniques in embedding and LLM fine-tuning. By applying self-supervised learning, domain adaptation, and prompt engineering, the system provides a robust solution that enhances user experience in customer-facing applications.</p> <hr> <h4 id="9-skills-and-tools-used"><strong>9. Skills and Tools Used</strong></h4> <ul> <li> <strong>Core Technologies</strong>: Large Language Models (LLMs), FAISS, RAG-Fusion</li> <li> <strong>Techniques</strong>: Prompt Engineering, Reciprocal Rank Fusion (RRF)</li> <li> <strong>Machine Learning Techniques</strong>: Contrastive Learning, Momentum Contrast (MoCo), Domain-Adaptive Pretraining (DAPT), In-Context Learning</li> <li> <strong>Application Focus</strong>: NLP, Conversational AI, Customer Support Systems</li> </ul> </article> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2024 Sina Torfi. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/assets/js/common.js?e0514a05c5c95ac1a93a8dfd5249b92e"></script> <script defer src="/assets/js/copy_code.js?12775fdf7f95e901d7119054556e495f" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> <script src="/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>addBackToTop();</script> </body> </html>